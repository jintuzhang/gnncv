# vim:ft=plumed
LOAD FILE=../../plumed_pytorch_gnn/PytorchGNN.so

MOLINFO STRUCTURE=../data/r.pdb PYTHON_BIN=python
GROUP ATOMS={@mdt:{all and not type H}} LABEL=g1
GROUP ATOMS=7,15,3,11 LABEL=g2

DISTANCE ATOMS=1,2   LABEL=d1
DISTANCE ATOMS=1,3   LABEL=d2
DISTANCE ATOMS=1,7   LABEL=d3
DISTANCE ATOMS=1,11  LABEL=d4
DISTANCE ATOMS=1,15  LABEL=d5
DISTANCE ATOMS=1,19  LABEL=d6
DISTANCE ATOMS=2,3   LABEL=d7
DISTANCE ATOMS=2,7   LABEL=d8
DISTANCE ATOMS=2,11  LABEL=d9
DISTANCE ATOMS=2,15  LABEL=d10
DISTANCE ATOMS=2,19  LABEL=d11
DISTANCE ATOMS=3,7   LABEL=d12
DISTANCE ATOMS=3,11  LABEL=d13
DISTANCE ATOMS=3,15  LABEL=d14
DISTANCE ATOMS=3,19  LABEL=d15
DISTANCE ATOMS=7,11  LABEL=d16
DISTANCE ATOMS=7,15  LABEL=d17
DISTANCE ATOMS=7,19  LABEL=d18
DISTANCE ATOMS=11,15 LABEL=d19
DISTANCE ATOMS=11,19 LABEL=d20
DISTANCE ATOMS=15,19 LABEL=d21

PYTORCH_MODEL FILE=../train_ff/model.ptc ARG=(d.*) LABEL=ff
PYTORCH_MODEL FILE=../train_ff_full/model.ptc ARG=(d.*) LABEL=ff_full

PYTORCH_GNN ...
  GROUPA=g1
  MODEL=../train_gnn/model.ptc
  STRUCTURE=../data/r.pdb
  NL_STRIDE=1000
  FLOAT64
  LABEL=gnn
... PYTORCH_GNN

COORDINATION GROUPA=1 GROUPB=g2 R_0=0.16 NN=6 LABEL=c1
COORDINATION GROUPA=2 GROUPB=g2 R_0=0.16 NN=6 LABEL=c2
CUSTOM ARG=c1,c2 FUNC=x-y PERIODIC=NO LABEL=x

PRINT ARG=x,ff.node-0,ff_full.node-0,gnn.node-0 FILE=colvar.eval
